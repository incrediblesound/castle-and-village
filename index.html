<!doctype html>
<html>
<head>
	<title></title>
	<link rel="stylesheet" type="text/css" href="./style.css">
</head>
<body>
	<div class="container">
		<div class="row">
			<h1 class="text-center">Castle and Village</h1>
		</div>
		<div class="row">
			<div class="col-md-4">
				<div class="row">
					<h2 class="text-center">Actions</h2>
					<div class="actions"></div>
				</div>
				<div class="row">
					<h2 class="text-center">Purchases</h2>
					<div class="purchase"></div>
				</div>
			</div>
			<div class="col-md-4">
				<ul class="todo">
				</ul>
				<button class='btn btn-default step'>Go</button>
				<div class="alerta">
					<p id="alert"><strong>Alerta</strong></p>
					<p id="alert-content"></p>
					<button id="alert-button">Close</button>
				</div>
			</div>
			<div class="col-md-4">
				<h2 class="text-center">Kingdom</h2>
				<div class="units"></div>
			</div>
		</div>
		<div class="row">
			<hr>
			
		</div>
	</div>
</body>
<script type="text/javascript" src="./bower_components/jquery/dist/jquery.min.js"></script>
	<script type="text/javascript" src="./src/system.js"></script>
	<script type="text/javascript" src="./src/actions.js"></script>
	<script type="text/javascript" src="./src/castle.js"></script>
	<script type="text/javascript" src="./src/village.js"></script>
	<script type="text/javascript" src="./src/domain.js"></script>
	<script type="text/javascript" src="./src/barracks.js"></script>
	<script type="text/javascript" src="./src/onstep.js"></script>
	<script type="text/javascript" src="./src/milestones.js"></script>
	<script type="text/javascript" src="./src/disasters.js"></script>
	<script type="text/javascript" src="./src/controller.js"></script>
	<link rel="stylesheet" type="text/css" href="./bower_components/bootstrap/dist/css/bootstrap.css">
<script type="text/javascript">
window.gameState = {};
window.gameState.actions = [];
window.gameState.stage = 1;

window.gameState.units = {};
window.gameState.units.castle = new Castle();
window.gameState.units.domain = new Domain();
window.gameState.units.barracks = new Barracks();
window.gameState.units.village = new Village();

window.gameState.controllers = {};
window.gameState.controllers.gameController = new Controller();
window.gameState.controllers.milestones = new MilestoneController();
window.gameState.controllers.actionController = new ActionController();
window.gameState.controllers.disasterController = new DisasterController()

$(function(){
	window.gameState.controllers.gameController.init()
	window.gameState.controllers.gameController.trigger('step');
  //load action on click and append to list
  $('.action').on('click', function(){
    console.log('hello');
    var text = $(this).text();
    window.gameState.actions.push(text);
    $('.todo').append('<li>'+text+'</li>')
  })

  $('.step').on('click', function(){
    $('.units').empty();
    
    //do all the actions
    for(var i = 0; i < window.gameState.actions.length; i ++){
      var action = window.gameState.actions[i];
      window.gameState.controllers.actionController.doAction(action);
    }

    window.gameState.actions = [];
    
    //render all the units
    //trigger all step functions
    window.gameState.controllers.gameController.trigger('step');
    
    //check and advance game stage
    if(window.gameState.stage < 24){
      window.gameState.stage += 1;
    } else {
      window.gameState.stage = 0;
    }
    $('.todo').empty();
    //end step function
    $('.action').on('click', function(){
    console.log('hello');
    var text = $(this).text();
    window.gameState.actions.push(text);
    $('.todo').append('<li>'+text+'</li>')
    })
  })
})

</script>

<div class="template">
	<h3 class="text-center name"></h3>
</div>

</html>